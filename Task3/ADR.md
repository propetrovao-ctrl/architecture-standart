### Название задачи: 
Открытие депозитов онлайн

### Автор:
Команда цифровой трансформации розничного бизнеса

### Дата:
16.11.2025

### Функциональные требования

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|UC1|Клиент, Сайт, Система кол-центра|Подача заявки на депозит через сайт (новый клиент)|1. Клиент заходит на сайт<br>2. Видит список депозитов с актуальными ставками<br>3. Заполняет форму заявки (Ф.И.О., телефон)<br>4. Отправляет заявку<br>5. Заявка передается в систему кол-центра<br>6. Менеджер кол-центра звонит клиенту<br>7. Клиент приходит в отделение для идентификации|
|UC2|Клиент, Интернет-банк, API Gateway, АБС, СМС-шлюз, Менеджер бэк-офиса|Подача заявки на депозит через интернет-банк (существующий клиент)|1. Клиент входит в интернет-банк<br>2. Видит список депозитов с актуальными и персонализированными ставками<br>3. Выбирает депозит, указывает счёт и сумму<br>4. Подтверждает операцию СМС-кодом<br>5. Заявка создается в системе через API Gateway<br>6. Менеджер бэк-офиса обрабатывает заявку в АБС<br>7. Клиент получает СМС-уведомление о подтверждении ставки<br>8. После открытия депозита клиент получает СМС-уведомление|
|UC3|Менеджер бэк-офиса депозитов, Менеджер бэк-офиса кредитов, АБС|Управление ставками в АБС|1. Сотрудники бэк-офиса депозитов и кредитов работают со ставками в АБС<br>2. Ставки хранятся в АБС (вместо Excel-файлов)<br>3. Ставки обновляются ежедневно|

### Нефункциональные требования

|**№**|**Требование**|
| :-: | :- |
|NFR1|Доступность сервисов 99.9%, работа 24/7|
|NFR2|Отклик по операциям в миллисекундах|
|NFR3|Шифрование трафика (HTTPS/TLS) для сайта и интернет-банка|
|NFR4|Горизонтальное масштабирование интернет-банка|
|NFR5|Избежать прямой работы интернет-банка с API АБС (база перегружена)|
|NFR6|Использовать технологии, которые уже есть в банке (MS SQL, Oracle, ASP.NET, Java)|
|NFR7|СМС-функционал реализовать силами банка, без доработки ядра подрядчиком|

### Решение
Приведите диаграммы контекста и контейнеров в модели C4. Опишите там основные компоненты и интеграции всех элементов решения. 

Диаграммы C4 представлены в отдельных файлах:
- `C4-Context-Diagram.puml` - диаграмма контекста (PlantUML)
- `C4-Container-Diagram.puml` - диаграмма контейнеров (PlantUML)

**Основные компоненты решения:**

1. **Сайт (PHP, React.js)** - для новых клиентов
   - Отображение списка депозитов с актуальными ставками
   - Форма подачи заявки
   - Интеграция с системой кол-центра

2. **Интернет-банк (ASP.NET MVC 4.5, MS SQL)**
   - Frontend (React.js) - пользовательский интерфейс
   - Backend (ASP.NET MVC 4.5) - бизнес-логика
   - MS SQL - база данных интернет-банка
   - Интеграция с API Gateway для работы с АБС
   - Интеграция с СМС-шлюзом для подтверждения операций

3. **API Gateway (Java)** - промежуточный сервис
   - Разделение нагрузки между интернет-банком и АБС
   - Кэширование данных для повышения производительности
   - Маршрутизация запросов к АБС

4. **Система кол-центра (Java, PostgreSQL)**
   - Прием заявок с сайта
   - Интерфейс для менеджеров кол-центра
   - Интеграция с API Gateway для передачи заявок в АБС

5. **АБС (Delphi, Oracle, PL-SQL)**
   - Клиент (Delphi) - интерфейс для менеджеров бэк-офиса
   - API (PL-SQL) - бизнес-логика и обработка запросов
   - Oracle - база данных АБС
   - Модуль управления ставками (вместо Excel)

6. **СМС-шлюз** - внешняя система для отправки СМС-уведомлений

**Логика принятия решений:**

- **Промежуточный сервис (API Gateway)**: Создан для избежания прямой нагрузки на АБС, так как база данных АБС уже перегружена. Это позволяет масштабировать интернет-банк горизонтально, не нагружая АБС.

- **Использование существующих технологий**: Выбраны технологии, которые уже есть в банке (MS SQL, Oracle, ASP.NET, Java), чтобы использовать имеющуюся экспертизу и не вводить новые технологии без необходимости.

- **Реализация СМС-функционала силами банка**: Избегаем доработки ядра интернет-банка подрядчиком, реализуем функционал как отдельный модуль, который может быть разработан командой банка.

- **Детализация интернет-банка и АБС**: Показаны основные компоненты этих систем для понимания архитектуры и интеграций.

### Альтернативы
Опишите здесь наиболее важные альтернативные решения.

**Альтернатива 1: Прямая интеграция интернет-банка с АБС**
- Недостатки: Перегрузка базы данных АБС, невозможность горизонтального масштабирования
- Отклонено из-за ограничений производительности АБС

**Альтернатива 2: Полная автоматизация процесса (без участия бэк-офиса)**
- Недостатки: Требует больше времени на разработку и тестирование
- Отложено на следующий этап, в MVP используется ручная обработка заявок

**Недостатки, ограничения, риски**

**Недостатки:**
- На этапе MVP требуется ручная обработка заявок менеджерами бэк-офиса
- Необходимость создания нового промежуточного сервиса (API Gateway)
- Ограничения по масштабированию из-за вертикального масштабирования АБС

**Ограничения:**
- АБС может масштабироваться только вертикально из-за своей базы данных
- Зависимость от подрядчика интернет-банка (обновление ядра привязано к подрядчику)
- Необходимость использования существующих технологий (MS SQL, Oracle)

**Риски:**
- Перегрузка АБС при большом количестве заявок (даже с промежуточным сервисом)
- Необходимость обеспечения безопасности передачи данных между системами
- Зависимость от подрядчика интернет-банка может замедлить разработку
- Сложность интеграции между системами на разных технологических стеках (ASP.NET, Java, Delphi)

