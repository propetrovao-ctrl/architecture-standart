### Название задачи: 
Передача ставок в кол-центр

### Автор:
Команда цифровой трансформации розничного бизнеса

### Дата:
16.11.2025

### Функциональные требования

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|UC1|АБС, API Gateway, Система кол-центра, Менеджер кол-центра|Получение ставок системой кол-центра через API|1. Ставки обновляются в АБС<br>2. API Gateway получает актуальные ставки из АБС<br>3. Система кол-центра запрашивает ставки через API Gateway<br>4. Менеджер кол-центра видит актуальные ставки в системе<br>5. Менеджер консультирует клиента по ставкам|
|UC2|АБС, SFTP-сервер, Система партнёрского кол-центра, Менеджер партнёрского кол-центра|Передача ставок в партнёрский кол-центр через SFTP|1. Ставки обновляются в АБС<br>2. АБС формирует файл со ставками<br>3. Файл передается на SFTP-сервер<br>4. Система партнёрского кол-центра получает файл с SFTP<br>5. Менеджер партнёрского кол-центра видит актуальные ставки<br>6. Менеджер консультирует клиента по ставкам|

### Нефункциональные требования

|**№**|**Требование**|
| :-: | :- |
|NFR1|Ставки должны обновляться автоматически при изменении в АБС|
|NFR2|Передача ставок должна быть надежной и безопасной|
|NFR3|SFTP-сервер должен быть развернут в инфраструктуре банка|
|NFR4|Использовать существующие технологии (Java для API, SFTP для файлов)|

### Решение
Приведите диаграммы контекста и контейнеров в модели C4. Опишите там основные компоненты и интеграции всех элементов решения. 

Диаграммы C4 представлены в отдельных файлах:
- диаграмма контекста
<img width="575" height="354" alt="image" src="https://github.com/user-attachments/assets/f1a74efb-4747-4131-a283-52fc3c751f6a" />

- диаграмма контейнеров
<img width="433" height="726" alt="image" src="https://github.com/user-attachments/assets/347b33f2-4c67-4d22-b06a-4c113193aee5" />

**Основные компоненты решения:**

1. **API Gateway** - расширение функционала
   - Добавление API для получения ставок
   - Получение ставок из АБС
   - Предоставление ставок системе кол-центра через REST API

2. **SFTP-сервер** - новый компонент
   - Развертывание в инфраструктуре банка
   - Хранение файлов со ставками
   - Доступ для системы партнёрского кол-центра

3. **АБС** - расширение функционала
   - Модуль формирования файлов со ставками
   - Автоматическая передача файлов на SFTP-сервер при обновлении ставок

4. **Система кол-центра** - расширение функционала
   - Интеграция с API Gateway для получения ставок
   - Отображение ставок в интерфейсе менеджеров

5. **Система партнёрского кол-центра** - внешняя система
   - Получение файлов со ставками с SFTP-сервера
   - Отображение ставок в интерфейсе

**Логика принятия решений:**

- **API для системы кол-центра**: Используется API Gateway, так как он уже создан для интеграции с АБС. Это позволяет получить ставки в реальном времени.

- **SFTP для партнёрского кол-центра**: Партнёрский кол-центр работает во внешней системе и не может делать API-вызовы. Используется SFTP для передачи файлов, что является стандартным решением для обмена данными с внешними системами.

- **Автоматическая передача**: При обновлении ставок в АБС автоматически формируется файл и передается на SFTP-сервер, а API Gateway обновляет кэш ставок.

### Альтернативы

**Альтернатива 1: Прямая интеграция системы кол-центра с АБС**
- Недостатки: Перегрузка базы данных АБС, нарушение архитектуры
- Отклонено из-за ограничений производительности АБС

**Альтернатива 2: Передача ставок в партнёрский кол-центр через API**
- Недостатки: Партнёрский кол-центр не может делать API-вызовы, это внешняя система
- Отклонено из-за технических ограничений партнёра

**Недостатки, ограничения, риски**

**Недостатки:**
- Необходимость развертывания SFTP-сервера
- Задержка в обновлении ставок в партнёрском кол-центре (файловая передача)
- Дополнительная нагрузка на инфраструктуру

**Ограничения:**
- Партнёрский кол-центр может получать данные только через файлы
- Необходимость синхронизации между API и файловой передачей

**Риски:**
- Задержка в получении актуальных ставок партнёрским кол-центром
- Проблемы с доступностью SFTP-сервера
- Необходимость обеспечения безопасности передачи файлов

**RoadMap :**
<img width="1401" height="676" alt="image" src="https://github.com/user-attachments/assets/130bfb83-d68c-4213-9b2f-1b2681562fd4" />



